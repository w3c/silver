<!--
Code for the tabbed interface for this W3C Silver Prototype was lovingly ripped from https://inclusive-components.design/tabbed-interfaces/ with the example code taken from https://codepen.io/heydon/pen/veeaEa .

All credit for this goes to Heydon Pickering https://twitter.com/heydonworks.
You should totally buy his book on Inclusive Components.
-->

<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Visual Contrast</title>
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
<p class="breadcrumb"><a href="../../guidelines/index.html">Silver</a> > <a href="../explainers/VisualContrast.html">Visual Contrast</a> > DEPRECIATED </p>
<div class="guidanceBox" style="color: #a00;background-color: #fdd; border-width: 8px;">
	<h1>THIS DOCUMENT IS DEPRECATED AND HAS BEEN SUPERSEDED.</h1>
	<h2>Please see the <a href="https://www.w3.org/TR/wcag-3.0/">current working draft</a></h2>
	<hr>
	<h3>Select font characteristics and background colors to provide enough contrast for readability </h3>
	<p>Use tools to evaluate font size, font stroke width, background color, font color, and nearby colors and adjust the properties of those elements to achieve good visual contrast and readability. </p>
</div>
<div class="informBox"
<p>This method contains helpful information, but is not required (informative).</p>
</div>
    <div class="tabbed">
      <ul>
        <li>
          <a href="#section1">Basics</a>
        </li>
        <li>
          <a href="#section2">Detailed<br />Description</a>
        </li>
        <li>
           <a href="#section3">Code<br />Samples</a>
        </li>
		 <li>
           <a href="#section4">Tests</a>
        </li>
         <li>
           <a href="#section5">Resources</a>
        </li>
		<li>
           <a href="#section6">Changelog</a>
        </li>
      </ul>

<section id="section1">
<h2>Basics</h2>
<h3>Status</h3>
<ul>
<li>Last Updated: 24 February 2020
<li>New
</ul> 
<h3>Platform</h3>
<p>Web
</p>
<h3>Programming Language</h3>
<ul>
<li>HTML - all versions
<li>CSS - all versions	
<li>Any web technology where text and background color are specified separately and browsers can control default colors. 
</ul>
<h3>How It Solves User Need</h3>
<p>All sighted users need adequate luminance contrast (lightness/darkness difference) between background and text colors in order to read the text easily.
</p>
<h3>Related Guidelines</h3>
<ul>
<li>TBD
</ul>
</section>

<section id="section2">
	
	
<h2>Detailed Description</h2>
<h3 id="understanding">Understanding Contrast Perception</h3>
<dl id="">
  <dd>
    <p>As used on this page, Visual Contrast means the perceived difference between two colors displayed on a computer monitor, such as the color of the text against the color of the background. Our perception of contrast is a function of the Human Visual System (HVS) which includes the eye, optic nerve, and several areas of the brain that are either dedicated to processing vision, or that share vision processing with other senses such as hearing.</p>
	<p>The eye consists of an optical portion including a lens, and a light sensitive portion known as the retina. Muscles in the eye adjust the shape of the lens to adjust the focus of incoming light, so that an image of the world around us is focused onto the retina. Light sensitive cells on the retina then convert light into electrical impulses that are sent to the brain's vision processing center, called the visual cortex.</p>
	  <p>This complex system is subject to many forms of impairment. And even "normal" vision changes substantially over a person's lifetime. For instance contrast sensitivity is very poor at birth, and it takes 20 years of development for normal vision to reach peak contrast sensitivity. Many people over the age of 45 develop the need for reading glasses as the natural lens in their eye grows larger and stiffer to where the muscles can no longer pull it into focus. And while people often think of acuity as a defining factor (i.e. 20/20, the ability to focus), vision is often more impacted by contrast sensitivity related impairments. 
	  
	<p>Our perception of contrast and ultimately the readability of text is affected by many interdependent factors, including:
	<ul>
		<li>The user's personal vision quality in terms of sharpness, glare, and contrast sensitivity		
		<li>Font weight or stroke width, and font size
		<li>The lightness or darkness difference between the background and the text
		<li>The overall lightness or darkness of the screen and the light in the room as this affects the eye's light or dark adaptation to the environment
		<li>The padding and spacing around the text which affects the eye's <em>local</em> adaptation to the text area
		<li>The hue or color difference between the background and text, not including the lightness difference	mentioned above
	  </ul>
	<p>All of these interdependent factors affect the perception of contrast and ultimately readability. As we are concerned with readability on computer screens, we can made some assumptions about a range of brightness, and a typical viewing environment. This provides a baseline standard for all users for best readability of content, or a minimum level of legibility for non-content. Then, we can set how different impairments require different adjustments or user customization to accommodate the needs of each individual user.</p>
	  <p>For instance, a user with poor "acuity", that is, poor sharpness where they cannot focus on small text, will need to be able to zoom the text larger. A user with poor contrast sensitivity may have good sharpness, but unable to perceive colors that are too similar in lightness. Yet another user with a glare problem may need lower contrast, and/or a reduction in blue, to reduce glare or halos interfering with readability. Those with a color vision problem (sometimes called 'color blind') may have difficulty detecting contrast or lightness for certain colors, such as deep red.

	    
	    </p>
  </dd>
</dl>
<div>
  
</div>
<dl id="">
  <h3>Predicted Lightness Contrast</h3>

</dl>
<div><span>DEPRECATED or OBSOLETE</span>
  <p>Predicted contrast is reported as "Lightness Contrast (Lc)" using the methods in this guideline, based on the CSS color values in sRGB colorspace, and with device default antialiasing<sup>1</sup>. The <b>Tests</b> section has a lookup table for specific font and contrast combinations, but as a general guide:</p>
	  
	  <ul>
	<li>15 is the point of invisibility (<em>i.e., no perceptible contrast</em>) for many people with contrast related impairments. Designers should assume that contrasts lower than this may be invisible to some users.
	<li>30 Cut off for all text regardless of use case.
	<li>45 for Large, Bold Headlines where the major stroke width is at least 8px (6pt), or Non-text elements that are at least a solid 8x8px square such as buttons.
	<li>60 For Bold Text no less than 16px (12pt) or non-text elements no less than 4px in the thinnest dimension.
	<li>75 Normal Weight Text no less than 16px (12pt) or non-text with a minimum stroke of 2px.
	<li>90 300 Weight Text no less than 16px (12pt) or non-text with a minimum stroke of 1px.
	</ul>	
		
  <p style="font-size: smaller;">Note: <sup>1</sup>These values require that antialiasing be at the device or user agent default, such that <em>added</em> antialiasing such as "Webkit-Font-Smoothing: Antialias;" is not enabled.</p>
</div>
<h3>Related Methods</h3>
<p><a href="Method-visual-contrast-default.html">Use default fonts and colors.</a>
</p>
<h3>Alternate Meanings</h3>
	<p>It's useful to point out that the term “Visual Contrast” can also be used to describe the differences of other visual perceptions: Contrast of size difference, contrast of position, contrast of speed or motion, etc. but these are not covered in this guideline at this time.</p>

</section>
	    
	    

<section id="section3" >
	
<h2>DEPRECATED or OBSOLETE Code Samples</h2>
Links to the current documents:<br>
<a href="https://www.w3.org/TR/wcag-3.0/">Current WCAG 3 Draft</a><br>
<a href="https://github.com/Myndex/apca-w3">Current APCA Code Repository</a><br>

<h3>Example Code for a Test Tool</h3>	
<div style="overflow: scroll;  background-color: #FED;">	
<pre><code>
////////////////////////////////////////////////////////////////////////////////
/////
/////   NOTICE: THIS FILE IS NOT BEING MAINTAINED AT THIS LOCATION
/////   FOR THE CURRENT FILE(S) PLEASE VISIT THE WCAG 3 WORKING DRAFT
/////   AND THE APCA GITHUB REPO:
/////   
/////   https://www.w3.org/TR/wcag-3.0/
/////
/////   APCA GITHUB: https://github.com/Myndex/apca-w3
/////   
////////////////////////////////////////////////////////////////////////////////

////////////////////////////////////////////////////////////////////////////////
/////
/////	*****  SAPC BLOCK  *****
/////
/////	For Evaluations, this is referred to as: SAPC-7
/////	sRGB Advanced Perceptual Contrast v0.97 beta JAVASCRIPT
/////	Copyright Â© 2019 by Andrew Somers
/////	Licensed to the W3C Per Collaborator Agreement
/////	SIMPLE VERSION â€” This Version Is Stripped Of Extensions:
/////		* No Color Vision Module
/////		* No Spatial Frequency Module
/////		* No Light Adaptation Module
/////		* No Dynamics Module
/////		* No Alpha Module
/////
////////////////////////////////////////////////////////////////////////////////


///// CONSTANTS USED IN THIS VERSION ///////////////////////////////////////////

	const sRGBtrc = 2.4;	// Gamma for sRGB linearization. 2.35 could be used instead
							// 2.4 emulates common monitor perceived EOTF

	const Rco = 0.2126;		// sRGB Red Coefficient
	const Gco = 0.7156;		// sRGB Green Coefficient
	const Bco = 0.0722;		// sRGB Blue Coefficient

	const scaleBoW = 114.0;	// Scaling for dark text on light (1.14 * 100)
	const scaleWoB = 114.0;	// Scaling for light text on dark â€” same as BoW, but
							// this is separate for possible future use.

	const normBGExp = 0.56;		// Constants for Power Curve Exponents.
	const normTXTExp = 0.57;	// One pair for normal text,and one for REVERSE
	const revBGExp = 0.62;		// FUTURE: These will eventually be dynamic
	const revTXTExp = 0.65;		// as a function of light adaptation and context

	const blkThrs = 0.022;	// Level that triggers the soft black clamp
	const blkClmp = 1.414;	// Exponent for the soft black clamp curve

/////      DEPRECATED or OBSOLETE - DO NOT USE

///// Ultra Simple Basic Bare Bones SAPC Function //////////////////////////////

/////      DEPRECATED or OBSOLETE - DO NOT USE

	// This REQUIRES linearized R,G,B values of 0.0-1.0

function SAPCbasic(Rbg,Gbg,Bbg,Rtxt,Gtxt,Btxt) {

	var	SAPC = 0.0;

	// Find Y by applying coefficients and sum.
	// This REQUIRES linearized R,G,B 0.0-1.0
	
	var	Ybg = Rbg*Rco + Gbg*Gco + Bbg*Bco;
	var	Ytxt = Rtxt*Rco + Gtxt*Gco + Btxt*Bco;

/////      DEPRECATED or OBSOLETE - DO NOT USE  

	// Now, determine polarity, soft clamp black, and calculate contrast
	// Finally scale for easy to remember percentages
	// Note that reverse (white text on black) intentionally
	// returns a negative number

	if ( Ybg &gt; Ytxt ) {	///// For normal polarity, black text on white

			// soft clamp darkest color if near black.
		Ytxt = (Ytxt &gt; blkThrs) ? Ytxt : Ytxt + Math.abs(Ytxt - blkThrs) ** blkClmp;
		SAPC = ( Ybg ** normBGExp - Ytxt ** normTXTExp ) * scaleBoW;
		
		return (SAPC &lt; 15 ) ? "0" : SAPC.toPrecision(3) + "Lc";
		
	} else {			///// For reverse polarity, white text on black

		Ybg = (Ybg &gt; blkThrs) ? Ybg : Ybg + Math.abs(Ybg - blkThrs) ** blkClmp;
		SAPC = ( Ybg ** revBGExp - Ytxt ** revTXTExp ) * scaleWoB;

		return (SAPC &gt; -15 ) ? "0" : SAPC.toPrecision(3) + "Lc";
	}

	// If SAPC's more than Lc 15, return that value, otherwise clamp to zero
	// this is to remove noise and unusual behavior if the user inputs
	// colors too close to each other.
	// This will be more important with future modules. Nevertheless
	// In order to simplify code, SAPC will not report accurate contrasts
	// of less than approximately 15, so those are clamped. 
	// 20 is the "point of invisibility" for many people.

}

/////      DEPRECATED or OBSOLETE - DO NOT USE  

//////////////////////////////////////////////////////////////
///// END OF SAPC BLOCK             //////////////////////////
//////////////////////////////////////////////////////////////



//////////////////////////////////////////////////////////////
///// sRGB INPUT FORM BLOCK         //////////////////////////
//////////////////////////////////////////////////////////////

/////      DEPRECATED or OBSOLETE - DO NOT USE  


function RGBColor(color_string) {
	
	this.ok = false;

	// strip any leading #
	if (color_string.charAt(0) == '#') {	// remove # if any
		color_string = color_string.substr(1,6);
	}
	color_string = color_string.replace(/ /g,'');	// strip spaces
	color_string = color_string.toLowerCase();		// set lowercase

	// before getting into regexps, try simple matches
	// and overwrite the input

	var simple_colors = {
		aliceblue: 'f0f8ff',
		antiquewhite: 'faebd7',
		aqua: '00ffff',
		aquamarine: '7fffd4',
		azure: 'f0ffff',
		beige: 'f5f5dc',
		bisque: 'ffe4c4',
		black: '000000',
		blanchedalmond: 'ffebcd',
		blue: '0000ff',
		blueviolet: '8a2be2',
		brown: 'a52a2a',
		burlywood: 'deb887',
		cadetblue: '5f9ea0',
		chartreuse: '7fff00',
		chocolate: 'd2691e',
		coral: 'ff7f50',
		cornflowerblue: '6495ed',
		cornsilk: 'fff8dc',
		crimson: 'dc143c',
		cyan: '00ffff',
		darkblue: '00008b',
		darkcyan: '008b8b',
		darkgoldenrod: 'b8860b',
		darkgray: 'a9a9a9',
		darkgreen: '006400',
		darkkhaki: 'bdb76b',
		darkmagenta: '8b008b',
		darkolivegreen: '556b2f',
		darkorange: 'ff8c00',
		darkorchid: '9932cc',
		darkred: '8b0000',
		darksalmon: 'e9967a',
		darkseagreen: '8fbc8f',
		darkslateblue: '483d8b',
		darkslategray: '2f4f4f',
		darkturquoise: '00ced1',
		darkviolet: '9400d3',
		deeppink: 'ff1493',
		deepskyblue: '00bfff',
		dimgray: '696969',
		dodgerblue: '1e90ff',
		feldspar: 'd19275',
		firebrick: 'b22222',
		floralwhite: 'fffaf0',
		forestgreen: '228b22',
		fuchsia: 'ff00ff',
		gainsboro: 'dcdcdc',
		ghostwhite: 'f8f8ff',
		gold: 'ffd700',
		goldenrod: 'daa520',
		gray: '808080',
		green: '008000',
		greenyellow: 'adff2f',
		honeydew: 'f0fff0',
		hotpink: 'ff69b4',
		indianred : 'cd5c5c',
		indigo : '4b0082',
		ivory: 'fffff0',
		khaki: 'f0e68c',
		lavender: 'e6e6fa',
		lavenderblush: 'fff0f5',
		lawngreen: '7cfc00',
		lemonchiffon: 'fffacd',
		lightblue: 'add8e6',
		lightcoral: 'f08080',
		lightcyan: 'e0ffff',
		lightgoldenrodyellow: 'fafad2',
		lightgrey: 'd3d3d3',
		lightgreen: '90ee90',
		lightpink: 'ffb6c1',
		lightsalmon: 'ffa07a',
		lightseagreen: '20b2aa',
		lightskyblue: '87cefa',
		lightslateblue: '8470ff',
		lightslategray: '778899',
		lightsteelblue: 'b0c4de',
		lightyellow: 'ffffe0',
		lime: '00ff00',
		limegreen: '32cd32',
		linen: 'faf0e6',
		magenta: 'ff00ff',
		maroon: '800000',
		mediumaquamarine: '66cdaa',
		mediumblue: '0000cd',
		mediumorchid: 'ba55d3',
		mediumpurple: '9370d8',
		mediumseagreen: '3cb371',
		mediumslateblue: '7b68ee',
		mediumspringgreen: '00fa9a',
		mediumturquoise: '48d1cc',
		mediumvioletred: 'c71585',
		midnightblue: '191970',
		mintcream: 'f5fffa',
		mistyrose: 'ffe4e1',
		moccasin: 'ffe4b5',
		navajowhite: 'ffdead',
		navy: '000080',
		oldlace: 'fdf5e6',
		olive: '808000',
		olivedrab: '6b8e23',
		orange: 'ffa500',
		orangered: 'ff4500',
		orchid: 'da70d6',
		palegoldenrod: 'eee8aa',
		palegreen: '98fb98',
		paleturquoise: 'afeeee',
		palevioletred: 'd87093',
		papayawhip: 'ffefd5',
		peachpuff: 'ffdab9',
		peru: 'cd853f',
		pink: 'ffc0cb',
		plum: 'dda0dd',
		powderblue: 'b0e0e6',
		purple: '800080',
		red: 'ff0000',
		rosybrown: 'bc8f8f',
		royalblue: '4169e1',
		saddlebrown: '8b4513',
		salmon: 'fa8072',
		sandybrown: 'f4a460',
		seagreen: '2e8b57',
		seashell: 'fff5ee',
		sienna: 'a0522d',
		silver: 'c0c0c0',
		skyblue: '87ceeb',
		slateblue: '6a5acd',
		slategray: '708090',
		snow: 'fffafa',
		springgreen: '00ff7f',
		steelblue: '4682b4',
		tan: 'd2b48c',
		teal: '008080',
		thistle: 'd8bfd8',
		tomato: 'ff6347',
		turquoise: '40e0d0',
		violet: 'ee82ee',
		violetred: 'd02090',
		wheat: 'f5deb3',
		white: 'ffffff',
		whitesmoke: 'f5f5f5',
		yellow: 'ffff00',
		yellowgreen: '9acd32'
	};

	for (var key in simple_colors) {
		if (color_string == key) {
			color_string = simple_colors[key];
		}
	}
	// end of simple type-in colors

/////      DEPRECATED or OBSOLETE - DO NOT USE  

	// array of color definition objects
	var color_defs = [
		{
			re: /^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,
			example: ['rgb(123, 234, 45)', 'rgb(255,234,245)'],
			process: function (bits){
				return [
					parseInt(bits[1]),
					parseInt(bits[2]),
					parseInt(bits[3])
				];
			}
		},
		{
			re: /^(\w{2})(\w{2})(\w{2})$/,
			example: ['#00ff00', '336699'],
			process: function (bits){
				return [
					parseInt(bits[1], 16),
					parseInt(bits[2], 16),
					parseInt(bits[3], 16)
				];
			}
		},
		{
			re: /^(\w{1})(\w{1})(\w{1})$/,
			example: ['#fb0', 'f0f'],
			process: function (bits){
				return [
					parseInt(bits[1] + bits[1], 16),
					parseInt(bits[2] + bits[2], 16),
					parseInt(bits[3] + bits[3], 16)
				];
			}
		}
	];



	// search through the definitions to find a match
	for (var i = 0; i &lt; color_defs.length; i++) {
		var re = color_defs[i].re;
		var processor = color_defs[i].process;
		var bits = re.exec(color_string);
		if (bits) {
			channels = processor(bits);
			this.r = channels[0];
			this.g = channels[1];
			this.b = channels[2];
			this.ok = true;
		}
	}


	// validate & cleanup values
	this.r = (this.r &lt; 0 || isNaN(this.r)) ? 0 : ((this.r &gt; 255) ? 255 : this.r);
	this.g = (this.g &lt; 0 || isNaN(this.g)) ? 0 : ((this.g &gt; 255) ? 255 : this.g);
	this.b = (this.b &lt; 0 || isNaN(this.b)) ? 0 : ((this.b &gt; 255) ? 255 : this.b);



	// some getters

	// returns rgb() value string
	this.toRGB = function () {
		return 'rgb(' + this.r + ',' + this.g + ',' + this.b + ')';
	}

	// returns rgb() value string
	this.toRGB2 = 'rgb(' + this.r + ', ' + this.g + ', ' + this.b + ')';


	// returns hex string
	this.toHex = function () {
		var r = this.r.toString(16);
		var g = this.g.toString(16);
		var b = this.b.toString(16);
		if (r.length == 1) r = '0' + r;
		if (g.length == 1) g = '0' + g;
		if (b.length == 1) b = '0' + b;
		return '#' + r + g + b;
	}

	// returns decimal array for R, G, and B
	this.toDec = function () {
		return [this.r/255.0,this.g/255.0,this.b/255.0];
	}

	// these return linearized R, G, or B

	this.Rlin = function () {
		return Math.pow(this.r/255.0, sRGBtrc);
	}
	this.Glin = function () {
		return Math.pow(this.g/255.0, sRGBtrc);
	}
	this.Blin = function () {
		return Math.pow(this.b/255.0, sRGBtrc);
	}


	this.toY = function () {
		return 	Math.pow(this.r/255.0, sRGBtrc) * Rco + Math.pow(this.g/255.0, sRGBtrc) * Gco + Math.pow(this.b/255.0, sRGBtrc) * Bco;
	}
}
/////      DEPRECATED or OBSOLETE - DO NOT USE  

//////////////////////////////////////////////////////////////
///// END sRGB INPUT FORM BLOCK 	//////////////////////
//////////////////////////////////////////////////////////////

</code></pre>
	</div>
	
	<h3>DEPRECATED HTML and Page Level Scripts</h3>

	<div style="overflow: scroll; background-color: #DEF;">
<pre><code>

&lt;?xml version="1.1" encoding="utf-8"?&gt;
&lt;!DOCTYPE html&gt;
&lt;head&gt;
&lt;title&gt;SAPC Contrast Demo&lt;/title&gt;

&lt;script src="SAPCsRGB.js"&gt;
// Place the above blocks in file SAPCsRGB.js
&lt;/script&gt;

&lt;script&gt;
		function getBGColor(s) {
			var BGcolor = new RGBColor(s);
			if (BGcolor.ok) {
			
				document.getElementById('BGresult').style.backgroundColor
					= 'rgb(' + BGcolor.r + ', ' + BGcolor.g + ', ' + BGcolor.b + ')';
				document.getElementById('sansSamples').style.backgroundColor
					= 'rgb(' + BGcolor.r + ', ' + BGcolor.g + ', ' + BGcolor.b + ')';
				document.getElementById('serifSamples').style.backgroundColor
					= 'rgb(' + BGcolor.r + ', ' + BGcolor.g + ', ' + BGcolor.b + ')';
					
				document.getElementById('BGresult-text').innerHTML =
					'&lt;code&gt;&lt;b&gt;HEX:&lt;/b&gt; ' + BGcolor.toHex()
					  + ' &lt;b&gt;sRGB:&lt;/b&gt; ' + BGcolor.toRGB()
					  + '&lt;br&gt;&lt;b&gt;Decimal:&lt;/b&gt; rgb( ' + BGcolor.toDec()[0].toPrecision(2)
					  + ', ' + BGcolor.toDec()[1].toPrecision(2)
					  + ', ' + BGcolor.toDec()[2].toPrecision(2)
					  + ' )&lt;br&gt;&lt;b&gt;Lin:&lt;/b&gt; R ' + BGcolor.Rlin().toPrecision(3)
					  + '&nbsp; G ' + BGcolor.Glin().toPrecision(3)
					  + '&nbsp; B ' + BGcolor.Blin().toPrecision(3)
					  + '&lt;br&gt;&lt;b&gt;Luminance:&lt;/b&gt; Y ' + BGcolor.toY().toPrecision(3) + '&lt;/code&gt;'
					  ;
			} else {
				document.getElementById('BGresult-text').innerHTML = 'Invalid Color';
				document.getElementById('BGresult').style.backgroundColor
					= 'rgb(255, 255, 255)';
			}
		}

		function getTextColor(s) {
			var textColor = new RGBColor(s);
			if (textColor.ok) {
			
				document.getElementById('textResult').style.backgroundColor
					= 'rgb(' + textColor.r + ', ' + textColor.g + ', ' + textColor.b + ')';
				document.getElementById('sansSamples').style.color
					= 'rgb(' + textColor.r + ', ' + textColor.g + ', ' + textColor.b + ')';
				document.getElementById('serifSamples').style.color
					= 'rgb(' + textColor.r + ', ' + textColor.g + ', ' + textColor.b + ')';	
					
				document.getElementById('textResult-text').innerHTML =
					'&lt;code&gt;&lt;b&gt;HEX:&lt;/b&gt; ' + textColor.toHex()
					  + ' &lt;b&gt;sRGB:&lt;/b&gt; ' + textColor.toRGB()
					  + '&lt;br&gt;&lt;b&gt;Decimal:&lt;/b&gt; rgb( ' + textColor.toDec()[0].toPrecision(2)
					  + ', ' + textColor.toDec()[1].toPrecision(2)
					  + ', ' + textColor.toDec()[2].toPrecision(2)
					  + ' )&lt;br&gt;&lt;b&gt;Lin:&lt;/b&gt; R ' + textColor.Rlin().toPrecision(3)
					  + '&nbsp; G ' + textColor.Glin().toPrecision(3)
					  + '&nbsp; B ' + textColor.Blin().toPrecision(3)
					  + '&lt;br&gt;&lt;b&gt;Luminance:&lt;/b&gt; Y ' + textColor.toY().toPrecision(3) + '&lt;/code&gt;'
					  ;
			} else {
				document.getElementById('textResult-text').innerHTML = 'Invalid Color';
				document.getElementById('textResult').style.backgroundColor = 'rgb(255, 255, 255)';
			}
		}
		
	&lt;/script&gt;
&lt;/head&gt;
&lt;body onLoad="document.getElementById('inputBG').focus(); document.getElementById('inputText').focus(); document.getElementById('inputBG').focus(); testContrast(); "&gt;

	&lt;div id="demoArea"&gt; 
	
		&lt;div id="contrast"&gt;        
			&lt;div id="contrastLabel"&gt;SAPC Contrast&lt;/div&gt;
			&lt;div id="contrastResult"&gt;NaN&lt;/div&gt;
        &lt;/div&gt;
       
        &lt;h1 style="text-align: left; "&gt;SAPC Visual Contrast Demo&lt;/h1&gt;

        &lt;div class=""&gt;
			This is the Basic SAPC contrast method using JavaScript. 
			&lt;br&gt;Just type in color values as #hex, rgb(), or HTML name 
			&lt;br&gt;then navigate away from the input field by either
			&lt;br&gt;pressing TAB or clicking elsewhere on the page.
        &lt;/div&gt;
    &lt;/div&gt;           


	&lt;div id="inputArea"&gt;        
		&lt;div style="position: relative; float: left;"&gt;
			&lt;h3&gt;ENTER BACKGROUND COLOR
			&lt;/h3&gt;
			&lt;form id="colorForm" name="colorForm" onsubmit="getBGColor(this.elements[0].value); getTextColor(this.elements[1].value); return false;"&gt;
				&lt;div class="input"&gt;
					&lt;input
						id="inputBG"
						type="text"
						value="#BA9"
						onblur="getBGColor(this.value); testContrast();"&gt;
				&lt;/div&gt;
		
			&lt;div id="BGresult-wrap"&gt;&lt;div id="BGresult"&gt;&lt;/div&gt;&lt;/div&gt;
			&lt;div class="codeBlock" id="BGresult-text"&gt;&lt;/div&gt;
	   &lt;/div&gt;
	
        
		&lt;div style="position: relative; float: right;"&gt;
			&lt;h3&gt;ENTER TEXT COLOR
			&lt;/h3&gt;
				&lt;div class="input"&gt;
					&lt;input
						id="inputText"
						type="text"
						value="#319"
						onblur="getTextColor(this.value); testContrast();"&gt;
				&lt;/div&gt;
			&lt;/form&gt;
			&lt;div id="textResult-wrap"&gt;&lt;div id="textResult"&gt;&lt;/div&gt;&lt;/div&gt;
			&lt;code id="textResult-text"&gt;&lt;/code&gt;
	
		&lt;/div&gt;
	&lt;/div&gt;

&lt;div style="font-size: 12px;"&gt;The page and code is Copyright © 2020 by Andrew Somers.
&lt;br&gt;Licensed to the W3.org per their cooperative agreement. 
&lt;br&gt;Otherwise under the GNU Affero General Public License v3.0 or later (AGPL-3.0-or-later).
&lt;br&gt;Repository: &lt;a href="https://github.com/Myndex/SAPC/tree/master/JS"&gt;https://github.com/Myndex/SAPC/tree/master/JS&lt;/a&gt;
&lt;br&gt;Color value input parsing based substantially on rgbcolor.js by
&lt;br&gt;Stoyan Stefanov &lt;sstoo@gmail.com&gt; used per MIT license.
&lt;br&gt;
This project is part of the &lt;a href="https://www.myndex.com/WEB/Perception"&gt;Myndex Web Perception Experiment.
&lt;/a&gt;
&lt;br&gt;&lt;br&gt;
    &lt;span onclick="testContrast()" style="cursor: pointer; text-decoration: underline"&gt;Manual Refresh&lt;/span&gt;

&lt;script&gt;
	function testContrast() {
		var BG = new RGBColor(document.getElementById('inputBG').value);
		var txt = new RGBColor(document.getElementById('inputText').value);
		
		document.getElementById('contrastResult').innerHTML =  SAPCbasic(BG.Rlin(),BG.Glin(),BG.Blin(),txt.Rlin(),txt.Glin(),txt.Blin());
	}
&lt;/script&gt;		
&lt;/body&gt;
&lt;/html&gt;

</code>
</pre>

</section>

<section id="section4">
<h2>Tests</h2>
<h3>Procedure</h3>
<ol>
<li>Using source code inspection or an “eye dropper” type tool, obtain representative sRGB values for the foreground text and the background color.  
	<ul style="font-size: smaller">
	<li>If an “eye dropper” type tool is used it must report values relative to the sRGB colorspace.
	<li>The eye dropper sample should be a pixel in the middle of a major stroke of the font at the smallest size to be tested, with the content size set to default with no user scaling.
	</ul>
<li>Using an automated tool like <a href="https://www.myndex.com/SAPC/">Advanced Perceptual Contrast Algorithm (APCA) Visual Contrast Demo</a> to calculate the lightness contrast between foreground text and background color.
	<ul style="font-size: smaller">
	<li>Important: do not swap the background or text colors in the tool entry fields.
	<li>The APCA tool predicts contrast based in part on polarity, so it is important that the text color CSS value be entered into the text color field, and likewise for the background.	
	</ul>	
<li>Compare this calculated value against the lookup table "Accessible Contrast by Font Size and Weight".
<li>Check that the absolute value of the lightness contrast percentage meets or exceeds the required value for the font weight and size.
</ol>
<h3>Accessible Contrast by Font Size and Weight</h3>
<p>Directions:  
<ul>
<li>Cross index nominal font size (in CSS px) to CSS weight.  
<li>APCA Contrast Percentage must meet or exceed the value listed. 
<li>For light text on a dark background the APCA tool will show a negative percentage. Simply use the absolute (positive) value. For example, if the APCA value is -58%, use 58%. 	
<li>A <span class="underWeight">&osol;</span> indicates that a larger font size (or heavier font weight) must be used. 
</ul>
</p>
    <style>
	td, th { text-align: center; }
	tr { border: 1px solid #004;}
	.TFtable { border: 2px solid #004; border-collapse: collapse;}
	th {background-color: #ABE;}
	th.fsize {background-color: #BCF;}
	td.do-not, .do-not {font-size: 1.4em; font-weight: bold; color: #B00;}
	</style>	
	
<table class="TFtable">
<tr>
<th class="fsize" >Font</th><th colspan="9" style="">Font Weight</th>
</tr>
<tr>
<th class="fsize">Size</th><th>100</th><th>200</th><th>300</th><th>400</br /><span style="font-size: smaller;">(Normal)</span></th><th>500</th><th>600</th><th>700</br /><span style="font-size: smaller;">(Bold)</span></th><th>800</th><th>900</th>
</tr>
<tr>
<td>12px</td><td class="do-not">&osol;</td><td class="do-not">&osol;</td><td class="do-not">&osol;</td><td class="do-not">&osol;</td>                     <td>90</td><td>80</td><td>75</td><td class="do-not">&osol;</td><td class="do-not">&osol;</td>
</tr>
<tr>
<td>14px</td><td class="do-not">&osol;</td><td class="do-not">&osol;</td><td class="do-not">&osol;</td>
                                         <td>90</td><td>80</td><td>75</td><td>70</td><td class="do-not">&osol;</td><td class="do-not">&osol;</td>
</tr>
<tr>
<td>16px</td><td class="do-not">&osol;</td><td class="do-not">&osol;</td><td>90</td><td>75</td><td>70</td><td>65</td><td>60</td><td>x50</td><td class="do-not">&osol;</td> 
</tr>
<tr>
<td>18px</td><td class="do-not">&osol;</td><td class="do-not">&osol;</td><td>80</td><td>65</td><td>60</td><td>55</td><td>50</td><td>x45</td><td>x45</td>
</tr>
<tr>
<td>24px</td><td class="do-not">&osol;</td>  
                   <td>90</td><td>75</td><td>60</td><td>55</td><td>50</td><td>45</td><td>x40</td><td>x35</td>
</tr>
<tr>
<td>36px</td><td class="do-not">&osol;</td>
                   <td>80</td><td>60</td><td>55</td><td>50</td><td>45</td><td>40</td><td>x30</td><td>NT</td>
</tr>
<tr>
<td>48px</td><td>90</td>
                   <td>70</td><td>55</td><td>50</td><td>45</td><td>40</td><td>30</td><td>NT</td><td>NT</td>
</tr>
<tr>
<td>60px</td><td>85</td>
                   <td>60</td><td>50</td><td>45</td><td>40</td><td>30</td><td>NT</td><td>NT</td><td>NT</td>
</tr>
<tr>
<td>72px</td><td>75</td>
                   <td>55</td><td>45</td><td>40</td><td>30</td><td>NT</td><td>NT</td><td>NT</td><td>NT</td>
</tr>
<tr>
<td>96px</td><td>70</td>
                   <td>50</td><td>40</td><td>30</td><td>NT</td><td>NT</td><td>NT</td><td>NT</td><td>NT</td>
</tr>
<tr>
<td>120px</td><td>60</td>
                   <td>45</td><td>30</td><td>NT</td><td>NT</td><td>NT</td><td>NT</td><td>NT</td><td>NT</td>
</tr>
</table>
</div>
<ul>
<li>Values shown are for common sans-serif fonts (e.g., Helvetica, Arial, Verdana, Calibri, Trebuchet).
<li>Serif fonts should use values for the row above (e.g., Times, Georgia, Cambria, Courier).
<li>Decorative, unusual, and very thin fonts should be avoided for columns of body text. 	
<li>Due to the vast variety of font designs, designers should visually compare an unusual font to a standard font such as Helvetica, using the size and weight of Helvetica that most closely matches the appearance of the tested font as a guide.
<li>Designers are cautioned that bypassing default font smoothing can drastically reduce contrast for small or thin fonts. For instance, the use of "webkit-font-smoothing: antialiasing" is strongly discouraged.	
</ul>
<h3>Expected Results</h3>
<ul>
    <li>#4 is true.
</ul>
</section>

<section id="section5">
<h2>Resources</h2>
	
<h3 id="math">APCA Math</h3>
	
<div>APCA is the <b>A</b>dvanced <b>P</b>erceptual <b>C</b>ontrast <b>A</b>lgorithm. The math assumes the use of the web standard sRGB colorspace.<BR><BR>

	<h3>The simplified steps are:</h3>
	<ul>
		<li>Convert the sRGB background and text colors to luminance Ybg and Ytxt
		<ul>
			<li>Convert from 8 bit integer to decimal 0.0-1.0
			<li>Linearize (remove gamma)
			<li>Apply sRGB coefficients and sum to Y<br>
			<img src="images/sRGBcoefficients.png">
					
		</ul>	
		<li>Determine which is brighter for contrast polarity
		<li>Apply pre-process modules (clamp, <em>FUTURE: color, spatial, adaptation</em>)
		<li>Apply power curve exponents for perceptual lightness
		<li>Find difference and scale to output percentage	
	</ul>

	<h2>Basic APCA Math Pseudocode</h2>	

	
  <p>In the sRGB colorspace, using CSS color values as integers, with a background color sRGB<sub>bg</sub> and a text color sRGB<sub>txt</sub> convert each channel to decimal 0.0-1.0 by dividing by 255, then linearize the gamma encoded RGB channels by applying a simple exponent. </p>
	  	

    <pre>	<strong>R<sub>linbg</sub></strong> = (sR<sub>bg</sub>/255.0) ^ 2.4
	<strong>G<sub>linbg</sub></strong> = (sG<sub>bg</sub>/255.0) ^ 2.4
	<strong>B<sub>linbg</sub></strong> = (sB<sub>bg</sub>/255.0) ^ 2.4</pre>
    <pre>	<strong>R<sub>lintxt</sub></strong> = (sR<sub>txt</sub>/255.0) ^ 2.4
	<strong>G<sub>lintxt</sub></strong> = (sG<sub>txt</sub>/255.0) ^ 2.4
	<strong>B<sub>lintxt</sub></strong> = (sB<sub>txt</sub>/255.0) ^ 2.4</pre>	  
 		
	  
<p>Then find the relative luminance (<var>Y</var>) of each color by applying the sRGB/Rec709 spectral coefficients and summing together.</p>
			
<pre>
	<strong>Y<sub>bg</sub></strong> = 0.2126 * R<sub>linbg</sub> + 0.7152 * G<sub>linbg</sub> + 0.0722 * B<sub>linbg</sub>
	<strong>Y<sub>txt</sub></strong> = 0.2126 * R<sub>lintxt</sub> + 0.7152 * G<sub>lintxt</sub> + 0.0722 * B<sub>lintxt</sub> </pre>
			
</div>
<dl id="dfn-relative-contrast">
  <h3>Lightness Contrast</h3>
  <dd>
    <p>The Predicted Visual Contrast (<var>APCA</var>) between a foreground color and a background color is expressed as Lc (Lightness Contrast) and is calculated by:</p>

<pre>
/////      DEPRECATED or OBSOLETE - DO NOT USE  

//  Define Constants for Basic APCA Version:

normBGExp = 0.56;	// Constants for Power Curve Exponents.
normTXTExp = 0.57;	// One pair for normal text, and one for REVERSE
revBGExp = 0.62;	// FUTURE: These will eventually be dynamic
revTXTExp = 0.65;	// as a function of light adaptation and context

blkThrs = 0.022;	// Level that triggers the soft black clamp
blkClmp = 1.414;	// Exponent for the soft black clamp curve

//  Calculate lightness contrast and return a string for the result

if Y<sub>bg</sub> &gt; Y<sub>txt</sub> then {
    Y<sub>txt</sub> = (Y<sub>txt</sub> > blkThrs) ? Y<sub>txt</sub> : Y<sub>txt</sub> + abs(Y<sub>txt</sub> - blkThrs) ^ blkClmp;
    APCA = ( Y<sub>bg</sub> ^ normBGExp - Y<sub>txt</sub> ^ normTXTExp ) * 114.0 - 2.7;
    return (APCA < 15 ) ? "0" : str(APCA) + "Lc";
  } else {
    Y<sub>bg</sub>g = (Y<sub>bg</sub> > blkThrs) ? Y<sub>bg</sub> : Y<sub>bg</sub> + abs(Y<sub>bg</sub> - blkThrs) ^ blkClmp;
    APCA = ( Y<sub>bg</sub> ^ revBGExp - Y<sub>txt</sub> ^ revTXTExp ) * 114.0 + 2.7;
    return (APCA > -15 ) ? "0" : str(APCA) + "Lc";
}
/////      DEPRECATED or OBSOLETE - DO NOT USE  

    </pre>

  </dd>
</dl>

<div><span><em>Notes:</em></span><smaller>
  <p>Predicted contrast less than 15 is clamped to zero to simplify the math. </p>
  <p><em>We will use the simple exponent, and not the piecewise sRGB transfer curve, as we are emulating display gamma and not performing image processing.</em> 
</p><p>The &ldquo;^&rdquo; character is the exponentiation operator.</p>
</smaller>	
</div>
	
<dl>
<dt></dt>
<dd></dd>
</dl>
<hr>	
<h2 id="glossary">Glossary</h2>
<ul>
	
<li><strong>Light — </strong>visible light is energy in a narrow range of frequencies or wavelengths that can be detected or sensed by “photo sensitive cells” in the back of the eye. 
<li><strong>Color — </strong>color is not real, but a perception or interpretation by visual processing in the brain (in the brain’s visual cortex) of stimulus from photosensitive cells in the eye. 
<ul><li><strong>Hue — </strong>refers to a particular color sensation, i.e. red, green, yellow, blue, etc. Hue does not exist in reality, it is solely the perception of the visual system responding to light of different frequencies.
<li><strong>Saturation — </strong>the color intensity or purity, reduced by:
<ul><li><strong>tint</strong> (add white), 
<li><strong>shade</strong> (add black), 
<li><strong>tone</strong> (add grey), 
</ul></ul>
<li><strong>Brightness — </strong>a relative perception, see also perceptual lightness.
<li><strong>Luminance (Y or L) — </strong>a physical measure of visible light intensity. Luminance is mathematically linear as light is in the real world.
<li><strong>Perceived Lightness (L*) — </strong>the perception of physical light intensity. Perceptual lightness is mathematically nonlinear in regards to light in the real world, however, some perceptual models attempt to provide a mathematically linear version of perception which then presents light as non-linear. The symbol L* refers to CIE L*a*b*, and should not be confused with luminance L.
<li><strong>Luma (<em>Y´</em> prime) — </strong> is a gamma encoded, weighted signal used in some video encodings. It is not to be confused with linear luminance.
<li><strong>Gamma — </strong> or transfer curve (TRC) is a curve that is commonly applied to image data for storage or broadcast to reduce perceived noise and improve data utilization.
<li><strong>Contrast — </strong>is a perception of the difference between two objects/elements. There are many forms of contrast, and the different types of contrast interact with and are affected by each other as well as being affected by other aspects of vision.
<ul><li><strong>Lightness contrast:</strong> the difference in lightness and darkness between two items. This is a particularly important form of contrast for information such as text.
<li><strong>Spatial contrast:</strong> in other words contrasts of size. Size contrasts directly affect the perception of lightness contrasts.
<li><strong>Hue contrast:</strong> the perception of different light frequencies. Hue contrasts are three times weaker than lightness contrasts, and some people have problems perceiving some hues, so hue should never be a primary design contrast.
<li><strong>Positional contrasts:</strong> the distance and/or orientation between objects is important in object recognition and identification.
<li><strong>Temporal contrasts:</strong> contrasts of time, speed, and change. 
</ul><li><strong>Visual Acuity — </strong>acuity refers to the ability of the eye’s optics to focus light onto the photoreceptors on the back of the eye.
<ul><li>Poor acuity is usually understood as blurry vision or an inability to focus.
</ul><li><strong>Spatial Frequency — </strong>in a practical sense, this refers to the weight of a font, or the stroke width. A thinner font or narrower stroke width is a higher spatial frequency than a bolder or thicker stroke. Higher spatial frequencies require more luminance contrast to be visible than lower frequencies, such as a very bold large headline.
</ul>

<hr>	
<h2 id="bibliography">Bibliography and References</h2>

<ul>	
<li><strong>TBD</strong>
</ul>
</section>

<section id="section6">
<h2>Changelog</h2>
<ul>
<li>20 January 2020 New Method 
<li>24 February 2020 First Working Draft Updates (corrected math, moved math and glossary to Resources tab, added description, added clarification to Tests tab). (AMS)
<li>25 February 2020 Addl. First Working Draft Updates (updated lookup table, minor spelling errors, added paragraph in Description, fixed formatting for code samples). (AMS)
<li>Nov 2021: Added depreciated notices as this document was superseded by the public working draft in 2021.(AMS)
	</ul>
	<h2 id="">THIS DOCUMENT IS NOT MAINTAINED</h2>
</section>


</div>

  </body>
  <script type="text/javascript" src="magicsauce.js"></script>
</html>
